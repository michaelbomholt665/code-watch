%%{init: {'theme': 'base', 'themeVariables': {'textColor': '#000000', 'primaryTextColor': '#000000', 'lineColor': '#333333'}, 'flowchart': {'nodeSpacing': 80, 'rankSpacing': 110, 'curve': 'basis'}}}%%
flowchart LR
  circular_cmd_circular["circular/cmd/circular\n(step:0)"]
  circular_internal_core_app["circular/internal/core/app\n(step:2)"]
  circular_internal_core_app_helpers["circular/internal/core/app/helpers\n(step:3)"]
  circular_internal_core_config["circular/internal/core/config\n(step:2)"]
  circular_internal_core_config_helpers["circular/internal/core/config/helpers\n(step:3)"]
  circular_internal_core_errors["circular/internal/core/errors\n(step:3)"]
  circular_internal_core_ports["circular/internal/core/ports\n(step:2)"]
  circular_internal_core_watcher["circular/internal/core/watcher\n(step:3)"]
  circular_internal_data_history["circular/internal/data/history\n(step:2)"]
  circular_internal_data_query["circular/internal/data/query\n(step:2)"]
  circular_internal_engine_architecture["circular/internal/engine/architecture\n(step:3)"]
  circular_internal_engine_graph["circular/internal/engine/graph\n(step:3)"]
  circular_internal_engine_parser["circular/internal/engine/parser\n(step:2)"]
  circular_internal_engine_parser_grammar["circular/internal/engine/parser/grammar\n(step:3)"]
  circular_internal_engine_parser_registry["circular/internal/engine/parser/registry\n(step:3)"]
  circular_internal_engine_resolver["circular/internal/engine/resolver\n(step:2)"]
  circular_internal_engine_resolver_drivers["circular/internal/engine/resolver/drivers\n(step:3)"]
  circular_internal_engine_secrets["circular/internal/engine/secrets\n(step:2)"]
  circular_internal_mcp_adapters["circular/internal/mcp/adapters\n(step:3)"]
  circular_internal_mcp_contracts["circular/internal/mcp/contracts\n(step:3)"]
  circular_internal_mcp_openapi["circular/internal/mcp/openapi\n(step:3)"]
  circular_internal_mcp_registry["circular/internal/mcp/registry\n(step:3)"]
  circular_internal_mcp_runtime["circular/internal/mcp/runtime\n(step:2)"]
  circular_internal_mcp_schema["circular/internal/mcp/schema\n(step:4)"]
  circular_internal_mcp_tools_graph["circular/internal/mcp/tools/graph\n(step:3)"]
  circular_internal_mcp_tools_query["circular/internal/mcp/tools/query\n(step:3)"]
  circular_internal_mcp_tools_report["circular/internal/mcp/tools/report\n(step:3)"]
  circular_internal_mcp_tools_scan["circular/internal/mcp/tools/scan\n(step:3)"]
  circular_internal_mcp_tools_secrets["circular/internal/mcp/tools/secrets\n(step:3)"]
  circular_internal_mcp_tools_system["circular/internal/mcp/tools/system\n(step:3)"]
  circular_internal_mcp_transport["circular/internal/mcp/transport\n(step:3)"]
  circular_internal_mcp_validate["circular/internal/mcp/validate\n(step:3)"]
  circular_internal_shared_observability["circular/internal/shared/observability\n(step:2)"]
  circular_internal_shared_util["circular/internal/shared/util\n(step:2)"]
  circular_internal_shared_version["circular/internal/shared/version\n(step:2)"]
  circular_internal_ui_cli["circular/internal/ui/cli\n(step:1)"]
  circular_internal_ui_report["circular/internal/ui/report\n(step:2)"]
  circular_internal_ui_report_formats["circular/internal/ui/report/formats\n(step:2)"]

  circular_cmd_circular --> circular_internal_ui_cli
  circular_internal_core_app --> circular_internal_core_app_helpers
  circular_internal_core_app --> circular_internal_core_config
  circular_internal_core_app --> circular_internal_core_errors
  circular_internal_core_app --> circular_internal_core_ports
  circular_internal_core_app --> circular_internal_core_watcher
  circular_internal_core_app --> circular_internal_data_history
  circular_internal_core_app --> circular_internal_data_query
  circular_internal_core_app --> circular_internal_engine_architecture
  circular_internal_core_app --> circular_internal_engine_graph
  circular_internal_core_app --> circular_internal_engine_parser
  circular_internal_core_app --> circular_internal_engine_resolver
  circular_internal_core_app --> circular_internal_engine_secrets
  circular_internal_core_app --> circular_internal_shared_observability
  circular_internal_core_app --> circular_internal_shared_util
  circular_internal_core_app --> circular_internal_shared_version
  circular_internal_core_app --> circular_internal_ui_report
  circular_internal_core_app_helpers --> circular_internal_core_config
  circular_internal_core_app_helpers --> circular_internal_core_ports
  circular_internal_core_app_helpers --> circular_internal_engine_graph
  circular_internal_core_app_helpers --> circular_internal_engine_parser
  circular_internal_core_app_helpers --> circular_internal_engine_secrets
  circular_internal_core_app_helpers --> circular_internal_shared_util
  circular_internal_core_app_helpers --> circular_internal_ui_report
  circular_internal_core_config --> circular_internal_core_config_helpers
  circular_internal_core_config --> circular_internal_shared_version
  circular_internal_core_ports --> circular_internal_core_config
  circular_internal_core_ports --> circular_internal_data_history
  circular_internal_core_ports --> circular_internal_data_query
  circular_internal_core_ports --> circular_internal_engine_graph
  circular_internal_core_ports --> circular_internal_engine_parser
  circular_internal_core_ports --> circular_internal_engine_resolver
  circular_internal_core_watcher --> circular_internal_shared_observability
  circular_internal_data_query --> circular_internal_data_history
  circular_internal_data_query --> circular_internal_engine_graph
  circular_internal_engine_architecture --> circular_internal_core_ports
  circular_internal_engine_architecture --> circular_internal_engine_graph
  circular_internal_engine_architecture --> circular_internal_shared_util
  circular_internal_engine_graph --> circular_internal_engine_parser
  circular_internal_engine_graph --> circular_internal_shared_observability
  circular_internal_engine_graph --> circular_internal_shared_util
  circular_internal_engine_parser --> circular_internal_core_errors
  circular_internal_engine_parser --> circular_internal_engine_parser_grammar
  circular_internal_engine_parser --> circular_internal_engine_parser_registry
  circular_internal_engine_parser --> circular_internal_shared_util
  circular_internal_engine_parser_grammar --> circular_internal_engine_parser_registry
  circular_internal_engine_parser_registry --> circular_internal_shared_util
  circular_internal_engine_resolver --> circular_internal_engine_graph
  circular_internal_engine_resolver --> circular_internal_engine_parser
  circular_internal_engine_resolver --> circular_internal_engine_resolver_drivers
  circular_internal_engine_resolver --> circular_internal_shared_observability
  circular_internal_engine_secrets --> circular_internal_core_config
  circular_internal_engine_secrets --> circular_internal_core_ports
  circular_internal_engine_secrets --> circular_internal_engine_parser
  circular_internal_mcp_adapters --> circular_internal_core_errors
  circular_internal_mcp_adapters --> circular_internal_core_ports
  circular_internal_mcp_adapters --> circular_internal_data_history
  circular_internal_mcp_adapters --> circular_internal_engine_parser
  circular_internal_mcp_adapters --> circular_internal_engine_secrets
  circular_internal_mcp_adapters --> circular_internal_mcp_contracts
  circular_internal_mcp_adapters --> circular_internal_shared_util
  circular_internal_mcp_openapi --> circular_internal_mcp_contracts
  circular_internal_mcp_runtime --> circular_internal_core_config
  circular_internal_mcp_runtime --> circular_internal_core_ports
  circular_internal_mcp_runtime --> circular_internal_data_history
  circular_internal_mcp_runtime --> circular_internal_mcp_adapters
  circular_internal_mcp_runtime --> circular_internal_mcp_contracts
  circular_internal_mcp_runtime --> circular_internal_mcp_openapi
  circular_internal_mcp_runtime --> circular_internal_mcp_registry
  circular_internal_mcp_runtime --> circular_internal_mcp_tools_graph
  circular_internal_mcp_runtime --> circular_internal_mcp_tools_query
  circular_internal_mcp_runtime --> circular_internal_mcp_tools_report
  circular_internal_mcp_runtime --> circular_internal_mcp_tools_scan
  circular_internal_mcp_runtime --> circular_internal_mcp_tools_secrets
  circular_internal_mcp_runtime --> circular_internal_mcp_tools_system
  circular_internal_mcp_runtime --> circular_internal_mcp_transport
  circular_internal_mcp_runtime --> circular_internal_mcp_validate
  circular_internal_mcp_runtime --> circular_internal_shared_observability
  circular_internal_mcp_runtime --> circular_internal_shared_util
  circular_internal_mcp_schema --> circular_internal_mcp_contracts
  circular_internal_mcp_tools_graph --> circular_internal_mcp_adapters
  circular_internal_mcp_tools_graph --> circular_internal_mcp_contracts
  circular_internal_mcp_tools_query --> circular_internal_mcp_adapters
  circular_internal_mcp_tools_query --> circular_internal_mcp_contracts
  circular_internal_mcp_tools_report --> circular_internal_mcp_contracts
  circular_internal_mcp_tools_scan --> circular_internal_mcp_adapters
  circular_internal_mcp_tools_scan --> circular_internal_mcp_contracts
  circular_internal_mcp_tools_secrets --> circular_internal_mcp_adapters
  circular_internal_mcp_tools_secrets --> circular_internal_mcp_contracts
  circular_internal_mcp_tools_system --> circular_internal_mcp_contracts
  circular_internal_mcp_transport --> circular_internal_core_config
  circular_internal_mcp_transport --> circular_internal_mcp_contracts
  circular_internal_mcp_transport --> circular_internal_mcp_schema
  circular_internal_mcp_transport --> circular_internal_shared_util
  circular_internal_mcp_validate --> circular_internal_mcp_contracts
  circular_internal_mcp_validate --> circular_internal_shared_util
  circular_internal_ui_cli --> circular_internal_core_app
  circular_internal_ui_cli --> circular_internal_core_config
  circular_internal_ui_cli --> circular_internal_core_ports
  circular_internal_ui_cli --> circular_internal_data_history
  circular_internal_ui_cli --> circular_internal_data_query
  circular_internal_ui_cli --> circular_internal_engine_parser
  circular_internal_ui_cli --> circular_internal_engine_resolver
  circular_internal_ui_cli --> circular_internal_engine_secrets
  circular_internal_ui_cli --> circular_internal_mcp_runtime
  circular_internal_ui_cli --> circular_internal_shared_observability
  circular_internal_ui_cli --> circular_internal_shared_util
  circular_internal_ui_cli --> circular_internal_shared_version
  circular_internal_ui_cli --> circular_internal_ui_report
  circular_internal_ui_cli --> circular_internal_ui_report_formats
  circular_internal_ui_report --> circular_internal_data_history
  circular_internal_ui_report --> circular_internal_engine_graph
  circular_internal_ui_report --> circular_internal_ui_report_formats
  circular_internal_ui_report_formats --> circular_internal_core_ports
  circular_internal_ui_report_formats --> circular_internal_engine_graph
  circular_internal_ui_report_formats --> circular_internal_engine_parser
  circular_internal_ui_report_formats --> circular_internal_engine_resolver
  circular_internal_ui_report_formats --> circular_internal_engine_secrets
  circular_internal_ui_report_formats --> circular_internal_shared_util
  circular_internal_ui_report_formats --> circular_internal_shared_version

  classDef flowNode fill:#f7fbff,stroke:#4d6480,stroke-width:1px,color:#000000;
  class circular_cmd_circular,circular_internal_core_app,circular_internal_core_app_helpers,circular_internal_core_config,circular_internal_core_config_helpers,circular_internal_core_errors,circular_internal_core_ports,circular_internal_core_watcher,circular_internal_data_history,circular_internal_data_query,circular_internal_engine_architecture,circular_internal_engine_graph,circular_internal_engine_parser,circular_internal_engine_parser_grammar,circular_internal_engine_parser_registry,circular_internal_engine_resolver,circular_internal_engine_resolver_drivers,circular_internal_engine_secrets,circular_internal_mcp_adapters,circular_internal_mcp_contracts,circular_internal_mcp_openapi,circular_internal_mcp_registry,circular_internal_mcp_runtime,circular_internal_mcp_schema,circular_internal_mcp_tools_graph,circular_internal_mcp_tools_query,circular_internal_mcp_tools_report,circular_internal_mcp_tools_scan,circular_internal_mcp_tools_secrets,circular_internal_mcp_tools_system,circular_internal_mcp_transport,circular_internal_mcp_validate,circular_internal_shared_observability,circular_internal_shared_util,circular_internal_shared_version,circular_internal_ui_cli,circular_internal_ui_report,circular_internal_ui_report_formats flowNode;
  classDef entryNode fill:#e9f5ec,stroke:#2f7d32,stroke-width:2px,color:#000000;
  class circular_cmd_circular entryNode;

  subgraph legend_info["Legend"]
    legend_nodes["Node label step:N = shortest hop distance from nearest entry point"]
    legend_entries["Green nodes = selected flow entry modules"]
  end
  classDef legendNode fill:#fff8dc,stroke:#b8a24c,stroke-width:1px,color:#000000;
  class legend_nodes,legend_entries legendNode;
